<!-- LKG patterns  -->
 <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pattern Adventure - Learn Numbers & Shapes</title>
    <style>
        body {
            font-family: 'Comic Sans MS', cursive, sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: #333;
            overflow: hidden;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        header {
            background-color: rgba(255, 255, 255, 0.9);
            padding: 10px;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            z-index: 10;
        }

        h1 {
            margin: 0;
            color: #764ba2;
            font-size: 2.5rem;
            text-shadow: 2px 2px 0px #f093fb;
        }

        .score-container {
            display: flex;
            justify-content: space-around;
            margin-top: 10px;
            font-size: 1.2rem;
            font-weight: bold;
        }

        .score {
            background-color: #f093fb;
            padding: 5px 15px;
            border-radius: 20px;
            color: white;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .level-indicator {
            background-color: #4facfe;
            padding: 5px 15px;
            border-radius: 20px;
            color: white;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .voice-button {
            background-color: #ff6b9d;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .voice-button:hover {
            background-color: #ff4d8f;
            transform: scale(1.1);
        }

        .voice-button.speaking {
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(255, 107, 157, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(255, 107, 157, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 107, 157, 0); }
        }

        main {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            position: relative;
        }

        .game-container {
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 20px;
            width: 90%;
            max-width: 900px;
            height: 70%;
            display: flex;
            flex-direction: column;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
            position: relative;
        }

        .question {
            text-align: center;
            font-size: 1.8rem;
            margin-bottom: 20px;
            color: #764ba2;
            font-weight: bold;
        }

        .pattern-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 20px 0;
            min-height: 120px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .pattern-item {
            width: 80px;
            height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            font-weight: bold;
            border-radius: 15px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
            animation: bounceIn 0.5s ease;
        }

        @keyframes bounceIn {
            0% { transform: scale(0); opacity: 0; }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); opacity: 1; }
        }

        .pattern-item.number {
            background-color: #ffeaa7;
            color: #2d3436;
        }

        .pattern-item.shape {
            background-color: #dfe6e9;
            color: #2d3436;
        }

        .pattern-item.missing {
            background-color: #ff7675;
            color: white;
            border: 3px dashed #2d3436;
            animation: blink 1.5s infinite;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .options-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .option {
            width: 80px;
            height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            font-weight: bold;
            border-radius: 15px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            transition: all 0.3s ease;
            background-color: #74b9ff;
            color: white;
        }

        .option:hover {
            transform: scale(1.1);
            background-color: #0984e3;
        }

        .option.selected {
            transform: scale(0.9);
            opacity: 0.6;
        }

        .feedback {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 3rem;
            font-weight: bold;
            color: #00b894;
            text-shadow: 2px 2px 0px #fff;
            opacity: 0;
            pointer-events: none;
            z-index: 100;
        }

        .correct-animation {
            animation: correctAnswer 1.5s ease-out;
        }

        .incorrect-animation {
            animation: incorrectAnswer 1.5s ease-out;
        }

        @keyframes correctAnswer {
            0% { opacity: 0; transform: translate(-50%, -50%) scale(0.5); }
            50% { opacity: 1; transform: translate(-50%, -50%) scale(1.2); }
            100% { opacity: 0; transform: translate(-50%, -50%) scale(1); }
        }

        @keyframes incorrectAnswer {
            0% { opacity: 0; transform: translate(-50%, -50%) rotate(0deg); }
            50% { opacity: 1; transform: translate(-50%, -50%) rotate(10deg); }
            100% { opacity: 0; transform: translate(-50%, -50%) rotate(0deg); }
        }

        .next-button {
            background-color: #00b894;
            color: white;
            border: none;
            border-radius: 30px;
            padding: 15px 30px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            margin-top: 20px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            align-self: center;
            display: none;
        }

        .next-button:hover {
            background-color: #00a085;
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }

        .next-button.show {
            display: block;
        }

        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: #f093fb;
            opacity: 0.8;
            border-radius: 50%;
            z-index: 1000;
        }

        .level-indicator-container {
            display: flex;
            justify-content: center;
            margin-top: 10px;
        }

        .level-dot {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            background-color: #ccc;
            margin: 0 5px;
            transition: all 0.3s ease;
        }

        .level-dot.active {
            background-color: #4facfe;
            transform: scale(1.2);
        }

        .level-dot.completed {
            background-color: #00b894;
        }

        .game-over {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.95);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border-radius: 20px;
            z-index: 200;
            display: none;
        }

        .game-over.show {
            display: flex;
        }

        .game-over h2 {
            font-size: 2.5rem;
            color: #764ba2;
            margin-bottom: 20px;
        }

        .final-score {
            font-size: 1.8rem;
            color: #00b894;
            margin-bottom: 30px;
        }

        .play-again-button {
            background-color: #00b894;
            color: white;
            border: none;
            border-radius: 30px;
            padding: 15px 30px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .play-again-button:hover {
            background-color: #00a085;
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }

        .level-complete {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.95);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border-radius: 20px;
            z-index: 200;
            display: none;
        }

        .level-complete.show {
            display: flex;
        }

        .level-complete h2 {
            font-size: 2.5rem;
            color: #764ba2;
            margin-bottom: 20px;
        }

        .level-score {
            font-size: 1.8rem;
            color: #00b894;
            margin-bottom: 30px;
        }

        .next-level-button {
            background-color: #00b894;
            color: white;
            border: none;
            border-radius: 30px;
            padding: 15px 30px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .next-level-button:hover {
            background-color: #00a085;
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }

        .star {
            position: absolute;
            font-size: 2rem;
            color: #ffeaa7;
            animation: twinkle 1.5s infinite alternate;
            z-index: -1;
        }

        @keyframes twinkle {
            0% { opacity: 0.3; }
            100% { opacity: 1; }
        }

        .voice-settings {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: rgba(255, 255, 255, 0.9);
            padding: 15px;
            border-radius: 15px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            z-index: 1000;
        }

        .voice-speed {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
        }

        .voice-speed label {
            font-weight: bold;
            color: #333;
        }

        .voice-speed input {
            width: 100px;
        }

        .voice-status {
            position: absolute;
            top: -40px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #ff6b9d;
            color: white;
            padding: 5px 10px;
            border-radius: 10px;
            font-size: 0.8rem;
            opacity: 0;
            transition: opacity 0.3s ease;
            white-space: nowrap;
        }

        .voice-status.show {
            opacity: 1;
        }

        .hint-button {
            background-color: #fdcb6e;
            color: #2d3436;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            font-size: 1.2rem;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            margin-left: 10px;
        }

        .hint-button:hover {
            background-color: #f39c12;
            transform: scale(1.1);
        }

        .hint-text {
            font-size: 1rem;
            color: #e17055;
            text-align: center;
            margin-top: 10px;
            font-style: italic;
            min-height: 20px;
        }
    </style>
</head>
<body>
    <header>
        <h1>Pattern Adventure</h1>
        <div class="score-container">
            <div class="score">Score: <span id="score">0</span></div>
            <div class="level-indicator">Level: <span id="level">1</span>/3</div>
            <div class="score">Round: <span id="round">1</span>/5</div>
            <button class="voice-button" id="voice-button" title="Female Voice Assistant">
                üë©‚Äçüè´
                <div class="voice-status" id="voice-status">Female Voice Active</div>
            </button>
            <button class="hint-button" id="hint-button" title="Get a hint!">üí°</button>
        </div>
        <div class="level-indicator-container">
            <div class="level-dot active" id="level1-dot"></div>
            <div class="level-dot" id="level2-dot"></div>
            <div class="level-dot" id="level3-dot"></div>
        </div>
    </header>

    <main>
        <div class="game-container">
            <div class="question" id="question">What comes next in the pattern?</div>
            
            <div class="pattern-container" id="pattern-container">
                <!-- Pattern items will be inserted here -->
            </div>
            
            <div class="hint-text" id="hint-text"></div>
            
            <div class="options-container" id="options-container">
                <!-- Options will be inserted here -->
            </div>
            
            <div class="feedback" id="feedback"></div>
            <button class="next-button" id="next-button">Next Question</button>
            
            <!-- Level complete screen -->
            <div class="level-complete" id="level-complete">
                <h2>Level Complete!</h2>
                <div class="level-score">Your Score: <span id="level-score">0</span>/5</div>
                <button class="next-level-button" id="next-level-button">Next Level</button>
            </div>
            
            <!-- Game over screen -->
            <div class="game-over" id="game-over">
                <h2>Amazing Job!</h2>
                <div class="final-score">Your Final Score: <span id="final-score">0</span>/15</div>
                <button class="play-again-button" id="play-again-button">Play Again</button>
            </div>
        </div>
    </main>

    <div class="voice-settings">
        <div class="voice-speed">
            <label for="voice-speed-slider">Voice Speed:</label>
            <input type="range" id="voice-speed-slider" min="0.5" max="1.5" step="0.1" value="0.9">
            <span id="voice-speed-value">0.9</span>
        </div>
    </div>

    <script>
        // Game data organized by levels
        const gameData = {
            level1: [
                {
                    question: "What comes next in the pattern?",
                    pattern: [1, 2, 3, 4, "?", 6],
                    answer: 5,
                    options: [5, 7, 3, 8],
                    type: "number",
                    hint: "Count the numbers! What comes after 4?"
                },
                {
                    question: "What comes next in the pattern?",
                    pattern: [2, 4, 6, 8, "?", 12],
                    answer: 10,
                    options: [9, 10, 11, 7],
                    type: "number",
                    hint: "These numbers are counting by 2s!"
                },
                {
                    question: "What comes next in the pattern?",
                    pattern: [1, 3, 5, 7, "?", 11],
                    answer: 9,
                    options: [8, 9, 10, 6],
                    type: "number",
                    hint: "These are odd numbers! What's the next odd number?"
                },
                {
                    question: "What comes next in the pattern?",
                    pattern: [10, 9, 8, 7, "?", 5],
                    answer: 6,
                    options: [4, 6, 3, 8],
                    type: "number",
                    hint: "The numbers are going down! What comes before 5?"
                },
                {
                    question: "What comes next in the pattern?",
                    pattern: [5, 10, 15, 20, "?", 30],
                    answer: 25,
                    options: [22, 25, 28, 21],
                    type: "number",
                    hint: "Count by 5s! 5, 10, 15, 20... what's next?"
                }
            ],
            level2: [
                {
                    question: "What comes next in the pattern?",
                    pattern: ["üîµ", "üî¥", "üîµ", "üî¥", "?", "üî¥"],
                    answer: "üîµ",
                    options: ["üîµ", "üî¥", "üü¢", "üü°"],
                    type: "shape",
                    hint: "Look at the colors! Blue, red, blue, red... what's next?"
                },
                {
                    question: "What comes next in the pattern?",
                    pattern: ["‚≠ê", "‚≠ê", "üåô", "‚≠ê", "‚≠ê", "?"],
                    answer: "üåô",
                    options: ["‚≠ê", "üåô", "‚òÄÔ∏è", "üí´"],
                    type: "shape",
                    hint: "Two stars, then one moon! What's missing?"
                },
                {
                    question: "What comes next in the pattern?",
                    pattern: ["üî∫", "üîª", "üî∫", "üîª", "?", "üîª"],
                    answer: "üî∫",
                    options: ["üî∫", "üîª", "‚¨ú", "‚≠ï"],
                    type: "shape",
                    hint: "Triangle up, triangle down, triangle up... what's next?"
                },
                {
                    question: "What comes next in the pattern?",
                    pattern: ["üåà", "‚òÄÔ∏è", "üåà", "‚òÄÔ∏è", "?", "‚òÄÔ∏è"],
                    answer: "üåà",
                    options: ["üåà", "‚òÄÔ∏è", "‚≠ê", "üåô"],
                    type: "shape",
                    hint: "Rainbow, sun, rainbow, sun... what's missing?"
                },
                {
                    question: "What comes next in the pattern?",
                    pattern: ["‚ù§Ô∏è", "üíô", "üíö", "‚ù§Ô∏è", "üíô", "?"],
                    answer: "üíö",
                    options: ["‚ù§Ô∏è", "üíô", "üíö", "üíõ"],
                    type: "shape",
                    hint: "Red, blue, green, then it repeats! What comes after blue?"
                }
            ],
            level3: [
                {
                    question: "What comes next in the pattern?",
                    pattern: [1, "üîµ", 2, "üî¥", 3, "?"],
                    answer: "üü¢",
                    options: ["üü¢", 4, "üîµ", 5],
                    type: "mixed",
                    hint: "Number, color, number, color... what color comes after 3?"
                },
                {
                    question: "What comes next in the pattern?",
                    pattern: ["‚≠ê", 2, "‚≠ê", 4, "‚≠ê", "?"],
                    answer: 6,
                    options: [5, 6, 7, "‚≠ê"],
                    type: "mixed",
                    hint: "Star, even number, star, even number... what's the next even number?"
                },
                {
                    question: "What comes next in the pattern?",
                    pattern: ["üî∫", "üî∫", 2, "üîª", "üîª", 4, "?", "?", 6],
                    answer: "üî∫",
                    options: ["üî∫", "üîª", 5, "‚≠ê"],
                    type: "mixed",
                    hint: "Two triangles up, number 2, two triangles down, number 4... what comes before 6?"
                },
                {
                    question: "What comes next in the pattern?",
                    pattern: [1, "üåô", 3, "üåô", 5, "?"],
                    answer: "üåô",
                    options: ["üåô", 7, 6, "‚≠ê"],
                    type: "mixed",
                    hint: "Odd number, moon, odd number, moon... what comes after 5?"
                },
                {
                    question: "What comes next in the pattern?",
                    pattern: ["‚ù§Ô∏è", 2, "üíô", 4, "‚ù§Ô∏è", 6, "?"],
                    answer: "üíô",
                    options: ["‚ù§Ô∏è", "üíô", 8, "üíö"],
                    type: "mixed",
                    hint: "Red heart, even number, blue heart, even number... what comes after 6?"
                }
            ]
        };

        // Game state
        let currentLevel = 1;
        let currentRound = 0;
        let score = 0;
        let levelScore = 0;
        let isAnswered = false;
        let currentQuestions = [];
        let voiceEnabled = true;
        let voiceSpeed = 0.9;
        let hintUsed = false;

        // DOM elements
        const questionElement = document.getElementById('question');
        const patternContainer = document.getElementById('pattern-container');
        const optionsContainer = document.getElementById('options-container');
        const feedbackElement = document.getElementById('feedback');
        const nextButton = document.getElementById('next-button');
        const scoreElement = document.getElementById('score');
        const levelElement = document.getElementById('level');
        const roundElement = document.getElementById('round');
        const levelCompleteElement = document.getElementById('level-complete');
        const levelScoreElement = document.getElementById('level-score');
        const nextLevelButton = document.getElementById('next-level-button');
        const gameOverElement = document.getElementById('game-over');
        const finalScoreElement = document.getElementById('final-score');
        const playAgainButton = document.getElementById('play-again-button');
        const level1Dot = document.getElementById('level1-dot');
        const level2Dot = document.getElementById('level2-dot');
        const level3Dot = document.getElementById('level3-dot');
        const voiceButton = document.getElementById('voice-button');
        const voiceSpeedSlider = document.getElementById('voice-speed-slider');
        const voiceSpeedValue = document.getElementById('voice-speed-value');
        const voiceStatus = document.getElementById('voice-status');
        const hintButton = document.getElementById('hint-button');
        const hintText = document.getElementById('hint-text');

        // Voice synthesis setup
        const synth = window.speechSynthesis;
        let voices = [];
        let femaleVoice = null;

        function populateVoices() {
            voices = synth.getVoices();
            
            // Prioritize female voices
            const preferredFemaleVoices = [
                'Google US English Female',
                'Google UK English Female',
                'Microsoft Zira Desktop',
                'Samantha',
                'Karen',
                'Moira',
                'Joanna',
                'Kendra',
                'Kimberly',
                'Salli'
            ];
            
            for (const preferredName of preferredFemaleVoices) {
                const found = voices.find(voice => 
                    voice.name.includes(preferredName)
                );
                if (found) {
                    femaleVoice = found;
                    break;
                }
            }
            
            if (!femaleVoice) {
                femaleVoice = voices.find(voice => 
                    voice.name.toLowerCase().includes('female')
                );
            }
            
            if (!femaleVoice && voices.length > 0) {
                femaleVoice = voices[0];
            }
        }

        if (speechSynthesis.onvoiceschanged !== undefined) {
            speechSynthesis.onvoiceschanged = populateVoices;
        }

        // Voice functions
        function speak(text, callback) {
            if (!voiceEnabled || !synth) {
                if (callback) callback();
                return;
            }

            synth.cancel();

            const utterance = new SpeechSynthesisUtterance(text);
            
            if (femaleVoice) {
                utterance.voice = femaleVoice;
            }
            
            utterance.rate = voiceSpeed;
            utterance.pitch = 1.3;
            utterance.volume = 0.9;
            
            if (callback) {
                utterance.onend = callback;
            }
            
            synth.speak(utterance);
        }

        function speakQuestion() {
            const currentQuestion = currentQuestions[currentRound];
            let questionText = currentQuestion.question + " ";
            
            // Read the pattern
            questionText += "The pattern is: ";
            currentQuestion.pattern.forEach((item, index) => {
                if (item === "?") {
                    questionText += "missing, ";
                } else {
                    questionText += item + ", ";
                }
            });
            
            // Read the options
            questionText += " Your options are: ";
            currentQuestion.options.forEach((option, index) => {
                questionText += option;
                if (index < currentQuestion.options.length - 1) {
                    questionText += ", ";
                }
            });
            
            questionText += ". What should go in the missing spot?";
            
            speak(questionText);
        }

        function speakFeedback(isCorrect) {
            if (isCorrect) {
                const encouragements = [
                    "Excellent! You found the pattern!",
                    "Great job! You're a pattern master!",
                    "Wow! You're so smart at patterns!",
                    "Amazing! You did it perfectly!",
                    "Super! That's exactly right!",
                    "Wonderful! You understand patterns so well!",
                    "Fantastic! Keep up the great work!",
                    "Brilliant! You're a pattern champion!"
                ];
                const randomEncouragement = encouragements[Math.floor(Math.random() * encouragements.length)];
                speak(randomEncouragement);
            } else {
                const encouragements = [
                    "Nice try! Look carefully at the pattern!",
                    "Almost there! Keep thinking!",
                    "Good effort! Let's try to find the pattern together!",
                    "Don't worry! Patterns can be tricky!",
                    "Keep trying! You're getting closer!",
                    "That's okay! Use the hint button if you need help!",
                    "No worries! Learning patterns takes practice!",
                    "You're doing great! Don't give up!"
                ];
                const randomEncouragement = encouragements[Math.floor(Math.random() * encouragements.length)];
                speak(randomEncouragement);
            }
        }

        function speakHint() {
            const currentQuestion = currentQuestions[currentRound];
            speak("Here's a hint: " + currentQuestion.hint);
        }

        function speakLevelComplete() {
            speak(`Great job! You completed level ${currentLevel} with a score of ${levelScore} out of 5!`);
        }

        function speakGameOver() {
            speak(`Amazing! You finished all levels with a final score of ${score} out of 15! You're a pattern expert!`);
        }

        // Voice controls
        voiceButton.addEventListener('click', () => {
            voiceEnabled = !voiceEnabled;
            voiceButton.textContent = voiceEnabled ? 'üë©‚Äçüè´' : 'üîá';
            
            if (voiceEnabled) {
                showVoiceStatus("Female Voice Active");
                speakQuestion();
            } else {
                showVoiceStatus("Voice Muted");
                synth.cancel();
            }
        });

        voiceButton.addEventListener('mouseenter', () => {
            if (voiceEnabled) {
                showVoiceStatus("Female Voice Active");
            } else {
                showVoiceStatus("Voice Muted");
            }
        });

        function showVoiceStatus(message) {
            voiceStatus.textContent = message;
            voiceStatus.classList.add('show');
            setTimeout(() => {
                voiceStatus.classList.remove('show');
            }, 2000);
        }

        voiceSpeedSlider.addEventListener('input', (e) => {
            voiceSpeed = parseFloat(e.target.value);
            voiceSpeedValue.textContent = voiceSpeed.toFixed(1);
        });

        // Hint functionality
        hintButton.addEventListener('click', () => {
            if (!hintUsed && !isAnswered) {
                hintUsed = true;
                const currentQuestion = currentQuestions[currentRound];
                hintText.textContent = currentQuestion.hint;
                speakHint();
            }
        });

        // Initialize the game
        function initGame() {
            currentLevel = 1;
            currentRound = 0;
            score = 0;
            levelScore = 0;
            isAnswered = false;
            hintUsed = false;
            scoreElement.textContent = score;
            levelElement.textContent = currentLevel;
            roundElement.textContent = currentRound + 1;
            gameOverElement.classList.remove('show');
            levelCompleteElement.classList.remove('show');
            nextButton.classList.remove('show');
            hintText.textContent = '';
            
            // Reset level indicators
            level1Dot.classList.add('active');
            level1Dot.classList.remove('completed');
            level2Dot.classList.remove('active', 'completed');
            level3Dot.classList.remove('active', 'completed');
            
            // Load first level
            loadLevel();
        }

        // Load a level
        function loadLevel() {
            currentRound = 0;
            levelScore = 0;
            isAnswered = false;
            hintUsed = false;
            nextButton.classList.remove('show');
            hintText.textContent = '';
            
            // Update level indicator
            levelElement.textContent = currentLevel;
            roundElement.textContent = currentRound + 1;
            
            // Update level dots
            if (currentLevel === 1) {
                level1Dot.classList.add('active');
                level1Dot.classList.remove('completed');
                level2Dot.classList.remove('active', 'completed');
                level3Dot.classList.remove('active', 'completed');
            } else if (currentLevel === 2) {
                level1Dot.classList.remove('active');
                level1Dot.classList.add('completed');
                level2Dot.classList.add('active');
                level2Dot.classList.remove('completed');
                level3Dot.classList.remove('active', 'completed');
            } else if (currentLevel === 3) {
                level1Dot.classList.remove('active');
                level1Dot.classList.add('completed');
                level2Dot.classList.remove('active');
                level2Dot.classList.add('completed');
                level3Dot.classList.add('active');
                level3Dot.classList.remove('completed');
            }
            
            // Get questions for current level
            currentQuestions = gameData[`level${currentLevel}`];
            
            // Load first question
            loadQuestion();
        }

        // Load a question
        function loadQuestion() {
            if (currentRound >= currentQuestions.length) {
                endLevel();
                return;
            }

            isAnswered = false;
            hintUsed = false;
            nextButton.classList.remove('show');
            hintText.textContent = '';
            
            const currentQuestion = currentQuestions[currentRound];
            questionElement.textContent = currentQuestion.question;
            
            // Clear previous content
            patternContainer.innerHTML = '';
            optionsContainer.innerHTML = '';
            
            // Create pattern items
            currentQuestion.pattern.forEach((item, index) => {
                const patternItem = document.createElement('div');
                patternItem.classList.add('pattern-item');
                
                if (item === "?") {
                    patternItem.classList.add('missing');
                    patternItem.textContent = "?";
                } else {
                    if (currentQuestion.type === "number") {
                        patternItem.classList.add('number');
                        patternItem.textContent = item;
                    } else {
                        patternItem.classList.add('shape');
                        patternItem.textContent = item;
                    }
                }
                
                // Add animation delay
                patternItem.style.animationDelay = `${index * 0.1}s`;
                
                patternContainer.appendChild(patternItem);
            });
            
            // Create options
            const shuffledOptions = [...currentQuestion.options].sort(() => Math.random() - 0.5);
            shuffledOptions.forEach(option => {
                const optionElement = document.createElement('div');
                optionElement.classList.add('option');
                optionElement.textContent = option;
                optionElement.dataset.value = option;
                
                optionElement.addEventListener('click', handleOptionClick);
                
                optionsContainer.appendChild(optionElement);
            });
            
            // Update round counter
            roundElement.textContent = currentRound + 1;
            
            // Add stars for decoration
            addStars();
            
            // Speak the question
            setTimeout(() => {
                speakQuestion();
            }, 1000);
        }

        // Handle option click
        function handleOptionClick(event) {
            if (isAnswered) return;
            
            isAnswered = true;
            const option = event.currentTarget;
            const selectedValue = option.dataset.value;
            const currentQuestion = currentQuestions[currentRound];
            const isCorrect = selectedValue == currentQuestion.answer;
            
            // Mark selected option
            option.classList.add('selected');
            
            if (isCorrect) {
                score++;
                levelScore++;
                scoreElement.textContent = score;
                showFeedback(true);
                createConfetti();
            } else {
                showFeedback(false);
            }
            
            // Speak feedback
            speakFeedback(isCorrect);
            
            nextButton.classList.add('show');
        }

        // Show feedback
        function showFeedback(isCorrect) {
            feedbackElement.textContent = isCorrect ? '‚úì Correct!' : '‚úó Try Again!';
            feedbackElement.classList.remove('correct-animation', 'incorrect-animation');
            
            if (isCorrect) {
                feedbackElement.classList.add('correct-animation');
            } else {
                feedbackElement.classList.add('incorrect-animation');
            }
            
            // Force reflow to restart animation
            void feedbackElement.offsetWidth;
        }

        // Create confetti effect
        function createConfetti() {
            const colors = ['#ff6b6b', '#4ecdc4', '#45b7d1', '#f9ca24', '#f0932b', '#eb4d4b', '#6ab04c', '#c44569', '#f093fb', '#4facfe'];
            
            for (let i = 0; i < 30; i++) {
                const confetti = document.createElement('div');
                confetti.classList.add('confetti');
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.left = `${Math.random() * 100}%`;
                confetti.style.top = `${Math.random() * 100}%`;
                
                // Random size
                const size = Math.random() * 10 + 5;
                confetti.style.width = `${size}px`;
                confetti.style.height = `${size}px`;
                
                // Random shape
                if (Math.random() < 0.5) {
                    confetti.style.borderRadius = '50%';
                } else {
                    confetti.style.borderRadius = '0';
                }
                
                // Random animation
                const duration = Math.random() * 2 + 1;
                const delay = Math.random() * 0.5;
                
                confetti.style.animation = `fall ${duration}s ease-out ${delay}s forwards`;
                
                document.querySelector('.game-container').appendChild(confetti);
                
                // Remove confetti after animation
                setTimeout(() => {
                    confetti.remove();
                }, (duration + delay) * 1000);
            }
        }

        // Add decorative stars
        function addStars() {
            // Remove existing stars
            document.querySelectorAll('.star').forEach(star => star.remove());
            
            // Add new stars
            for (let i = 0; i < 5; i++) {
                const star = document.createElement('div');
                star.classList.add('star');
                star.textContent = '‚≠ê';
                star.style.left = `${Math.random() * 90 + 5}%`;
                star.style.top = `${Math.random() * 90 + 5}%`;
                document.querySelector('.game-container').appendChild(star);
            }
        }

        // End the level
        function endLevel() {
            levelScoreElement.textContent = levelScore;
            levelCompleteElement.classList.add('show');
            
            // Mark current level as completed
            if (currentLevel === 1) {
                level1Dot.classList.remove('active');
                level1Dot.classList.add('completed');
            } else if (currentLevel === 2) {
                level2Dot.classList.remove('active');
                level2Dot.classList.add('completed');
            } else if (currentLevel === 3) {
                level3Dot.classList.remove('active');
                level3Dot.classList.add('completed');
            }
            
            // Speak level complete message
            speakLevelComplete();
        }

        // End the game
        function endGame() {
            finalScoreElement.textContent = score;
            gameOverElement.classList.add('show');
            
            // Speak game over message
            speakGameOver();
        }

        // Event listeners
        nextButton.addEventListener('click', () => {
            currentRound++;
            loadQuestion();
        });
        
        nextLevelButton.addEventListener('click', () => {
            levelCompleteElement.classList.remove('show');
            currentLevel++;
            
            if (currentLevel > 3) {
                endGame();
            } else {
                loadLevel();
            }
        });
        
        playAgainButton.addEventListener('click', () => {
            gameOverElement.classList.remove('show');
            initGame();
        });

        // Add falling animation for confetti
        const style = document.createElement('style');
        style.textContent = `
            @keyframes fall {
                0% {
                    transform: translateY(0) rotate(0deg);
                    opacity: 1;
                }
                100% {
                    transform: translateY(300px) rotate(360deg);
                    opacity: 0;
                }
            }
        `;
        document.head.appendChild(style);

        // Initialize the game on load
        window.addEventListener('load', () => {
            initGame();
            populateVoices();
        });
    </script>
</body>
</html>
